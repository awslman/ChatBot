package Data;import java.util.Date;/** * 对话历史双向链表 * 用于存储和管理对话历史记录，支持前后浏览历史消息 * 使用双向链表结构便于在历史记录中前后移动 */public class DialogueHistory {    /**     * 链表头节点     */    private DialogueNode head;        /**     * 链表尾节点     */    private DialogueNode tail;        /**     * 当前查看位置节点     */    private DialogueNode current; // 当前查看位置        /**     * 链表中消息节点的数量     */    private int size;    /**     * 构造函数，初始化空的对话历史链表     */    public DialogueHistory() {        head = null;        tail = null;        current = null;        size = 0;    }    /**     * 添加新消息到对话历史链表尾部     * 新消息成为最新的消息，并将当前查看位置重置到最新消息     *      * @param message 要添加的消息对象     */    public void addMessage(Message message) {        DialogueNode newNode = new DialogueNode(message);        if (head == null) {            head = newNode;        } else {            tail.next = newNode;            newNode.prev = tail;        }        tail = newNode;        current = newNode; // 重置当前位置到最新        size++;    }    /**     * 向前查看历史消息（向链表头部方向移动）     *      * @return 前一个历史消息，如果已经是最早的则返回null     */    public Message moveBackward() {        if (current == null || current.prev == null) {            return null;        }        current = current.prev;        return current.message;    }    /**     * 向后查看历史消息（向链表尾部方向移动）     *      * @return 后一个历史消息，如果已经是最新则返回null     */    public Message moveForward() {        if (current == null || current.next == null) {            return null;        }        current = current.next;        return current.message;    }    /**     * 获取当前查看位置的消息     *      * @return 当前消息，如果无消息则返回null     */    public Message getCurrent() {        return current != null ? current.message : null;    }    /**     * 重置当前查看位置到最新消息     */    public void resetToLatest() {        current = tail;    }    /**     * 获取对话历史中的消息总数     *      * @return 消息数量     */    public int getSize() {        return size;    }    /**     * 打印所有历史消息     * 按时间顺序显示所有对话历史记录     */    public void printHistory() {        DialogueNode temp = head;        System.out.println("=== 对话历史 ===");        while (temp != null) {            System.out.println("["+new Date(temp.message.getTimestamp()) + "] " + temp.message);            temp = temp.next;        }        System.out.println("================");    }    /**     * 获取历史链表的尾部节点     *      * @return 链表尾部节点     */    public DialogueNode getTail() {        return tail;    }}
import com.alibaba.dashscope.app.*;import com.alibaba.dashscope.exception.ApiException;import com.alibaba.dashscope.exception.InputRequiredException;import com.alibaba.dashscope.exception.NoApiKeyException;import java.util.Arrays;import java.lang.System;import com.alibaba.dashscope.aigc.generation.Generation;import com.alibaba.dashscope.aigc.generation.GenerationParam;import com.alibaba.dashscope.aigc.generation.GenerationResult;import com.alibaba.dashscope.common.Message;import com.alibaba.dashscope.common.Role;/** * LLM响应生成类 * 提供调用大语言模型生成响应的功能 */public class LLMResponseGenerate {        private static final String DEFAULT_MODEL = "qwen-plus";    private static final String APP_ID = "149e0903bcb743b09108b6cfb0d7c35b";    private static final String SYSTEM_MESSAGE = "You are a helpful assistant.";        /**     * 调用应用程序接口生成响应     *     * @throws ApiException API调用异常     * @throws NoApiKeyException 缺少API密钥异常     * @throws InputRequiredException 输入缺失异常     */    public static void appCall()            throws ApiException, NoApiKeyException, InputRequiredException {        String apiKey = System.getenv("DASHSCOPE_API_KEY");        if (apiKey == null || apiKey.isEmpty()) {            throw new NoApiKeyException();        }                ApplicationParam param = ApplicationParam.builder()                .apiKey(apiKey)                .appId(APP_ID)                .prompt("你是谁？")                .build();        Application application = new Application();        ApplicationResult result = application.call(param);        System.out.printf("text: %s\n",                result.getOutput().getText());    }    /**     * 使用消息方式调用大语言模型生成响应     *      * @return 返回生成结果对象     * @throws ApiException API调用异常     * @throws NoApiKeyException 缺少API密钥异常     * @throws InputRequiredException 输入缺失异常     */    public static GenerationResult callWithMessage() throws ApiException, NoApiKeyException, InputRequiredException {        String apiKey = System.getenv("DASHSCOPE_API_KEY");        if (apiKey == null || apiKey.isEmpty()) {            throw new NoApiKeyException();        }                Generation gen = new Generation();        // 构建系统角色消息，定义助手的行为        Message systemMsg = Message.builder()                .role(Role.SYSTEM.getValue())                .content(SYSTEM_MESSAGE)                .build();        // 构建用户消息，包含用户的问题        Message userMsg = Message.builder()                .role(Role.USER.getValue())                .content("你是谁？")                .build();        GenerationParam param = GenerationParam.builder()                .apiKey(apiKey)                .model(DEFAULT_MODEL)                .messages(Arrays.asList(systemMsg, userMsg))                .resultFormat(GenerationParam.ResultFormat.MESSAGE)                .build();        return gen.call(param);    }    /**     * 使用用户输入调用大语言模型生成响应     *     * @param userInput 用户输入的内容     * @return 返回模型生成的文本内容     * @throws ApiException API调用异常     * @throws NoApiKeyException 缺少API密钥异常     * @throws InputRequiredException 输入缺失异常     */    public static String callLLMWithUserInput(String userInput)            throws ApiException, NoApiKeyException, InputRequiredException {        if (userInput == null || userInput.isEmpty()) {            throw new InputRequiredException("Input is required but got null or empty.");        }                String apiKey = System.getenv("DASHSCOPE_API_KEY");        if (apiKey == null || apiKey.isEmpty()) {            throw new NoApiKeyException();        }                Generation gen = new Generation();        // 构建系统角色消息，定义助手的行为        Message systemMsg = Message.builder()                .role(Role.SYSTEM.getValue())                .content(SYSTEM_MESSAGE)                .build();        // 构建用户消息，包含实际的用户输入        Message userMsg = Message.builder()                .role(Role.USER.getValue())                .content(userInput)                .build();        GenerationParam param = GenerationParam.builder()                .apiKey(apiKey)                .model(DEFAULT_MODEL)                .messages(Arrays.asList(systemMsg, userMsg))                .resultFormat(GenerationParam.ResultFormat.MESSAGE)                .build();        GenerationResult result = gen.call(param);                // 检查结果是否有效        if (result.getOutput() == null || result.getOutput().getChoices() == null ||            result.getOutput().getChoices().isEmpty()) {            throw new  InputRequiredException("Invalid result.");        }                return result.getOutput().getChoices().get(0).getMessage().getContent();    }    /**     * 主函数，程序入口点     *      * @param args 命令行参数     */    public static void main(String[] args) {        try {            GenerationResult result = callWithMessage();            System.out.println(result.getOutput().getChoices().get(0).getMessage().getContent());        } catch (ApiException | NoApiKeyException | InputRequiredException e) {            System.err.println("错误信息："+e.getMessage());            System.out.println("请参考文档：https://help.aliyun.com/zh/model-studio/developer-reference/error-code");        }        System.exit(0);    }}